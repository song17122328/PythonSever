Abstract —Lithium–Sulfur (Li–S) battery technology is consid-ered for an application in an electric-vehicle energy storage system in this study. A new type of Li-S cell is tested by applying load current and measuring cell’s terminal voltage in order to parame-terize an equivalent circuit network model. Having the cell’s model, the possibility of state-of-charge (SOC) estimation is assessed by performing an observability analysis. The results demonstrate that the Li –S cell model is not fully observable because of the particular shape of cell’s open-circuit voltage curve. This feature distinguishes Li-S batteries from many other types of battery, e.g., Li-ion and NiMH. As a consequence, a Li-S cell’s SOC cannot be estimated using existing methods in the literature and special considerations are needed. To solve this problem, a new framework is proposed consisting of online battery parameter identiﬁcation in conjunction with an estimator that is trained to use the identiﬁed parameters to predict SOC. 
The idenﬁcation part is based on the well-known prediction-error minimization algorithm; and the SOC estimator part is an adaptive neuro-fuzzy inference system in combination with coulomb counting. Using the proposed method, a Li-S cell’s SOC is estimated with a mean error of 4% and maximum error of 7% in a realistic driving scenario.
DEVELOPMENT of energy storage systems can beconsidered as the heart of vehicle electriﬁcation process. Different new technologies for batteries, fuel cells, ultraca-pacitors, etc., are developing to be implemented in electric vehicles (EVs). One such new energy storage technology is the Lithium–Sulfur (Li-S) battery. Compared to incumbent Li-ion technologies, Li-S batteries have higher speciﬁc energy, im- proved safety, wider operational temperature range, and – when productionized – a lower unit cost due to the wide availabilityof sulfur, and consequently, Li-S is receiving serious research attention. 
This work was undertaken as a part of an industrial project, aiming to develop and deploy experimental Li-S cells in an automotive application. Regardless of the state of develop- ment of the chemistry, it is important to be able to operate cells in practical applications, and this study is focused on Li-S cell parameter identiﬁcation and state-of-charge (SOC) estimation. There are different methods in the literature for battery SOC estimation [3]–[5]. Good reviews of these methods can be found in [6] and [7]. The most widespread conventional method, used as a benchmark for evaluation of other techniques, is “coulomb-counting.” In this concept, an SOC is estimated by integrating the load current; this way, capacity used and remaining can be estimated. Assuming SOC0 as the initial SOC at time t0 , the cell’s SOC at time t is calculated as follows:
where i(t) is the current (A) assumed positive for discharging and negative for charging. γ is the cell’s coulombic efﬁciency (dimensionless) and Ct is the total capacity (As). In this rep-resentation, the SOC value is a number between 0 and 1 with 0 indicating a fully depleted state and 1 representing a fully charged state.
Although coulomb-counting is quite useful, it cannot always be used in practice because it can only start to estimate from a given initial SOC value. 
Another problem is that the battery capacity (Ct ) might change under various conditions (e.g., temperature variation), which can lead to errors when using coulomb-counting.
The most common parameter for this pur-pose is the battery’s open-circuit-voltage (OCV).
Prediction-error minimization (PEM) algorithm and adaptive neuro-fuzzy inference system (ANFIS) in combina-tion with coulomb counting are used for model identiﬁcation and SOC estimation, respectively. 
The PEM is a fast identiﬁ-cation algorithm in which the prediction error (as a function of the model’s parameters) is minimized using an iterative proce-dure [23]. 
ANFIS is a powerful tool for modeling, prediction, and control by integrating synergy of the artiﬁcial neural net-work and the fuzzy logic. 
A fuzzy set (which works based on fuzzy logic) is an efﬁcient tool for modeling of a phenomenon related to human knowledge by using linguistic labels that are embedded in a number of membership functions. A fuzzy infer- ence system (FIS) is a collection of fuzzy if-then rules, which contains human expertise and knowledge. 
A hybrid learning approach is used in ANFIS structure that combines the gradient-descent and the least squares meth-ods for the parameter tuning. ANFIS has been used in a wide range of applications and particularly, it has been used for bat-tery SOC estimation in previous studies [24], [25]. 
A large volume of test data is needed to cover all the possible variables such as SOC, temperature, ageing, current demand, and so on. 
Another group of existing SOC estimation algorithms are re-cursive adaptive ﬁlters such as particle ﬁlter and Kalman ﬁlter-based SOC estimators [11]–[15], which are particularly used for automotive application as well [16]–[19]. 
Pure coulomb-counting is used as a bench mark to evaluate the estimation results. Because of the application of this study in EVs, the goal is to have a simple and fast method that is applicable in real-time.
So, an ECN modeling approach [27]–[29] is selected. A review on different battery modeling approaches can be found in [27]. 
The PEM algorithm [23] is utilized as the identiﬁcation al-gorithm. 
For a sufﬁciently economical model structure, PEM is fast enough to be used in real-time applications such as a battery management system (BMS). In the identiﬁcation procedure, the model parameter vector (θ) is determined so that the prediction error (ε) is minimized, which is deﬁned as follows:
In this study, the parameters vector contains cell’s internal resistance and OCV. The parameters are optimized so that the least difference between measured terminal voltage (Vt ) and model’s output is achieved energy density more than 400 Wh/kg [26]. 
In this section, an equivalent-circuit-network (ECN) model is parameterized using experimental data from Li-S cells.
NiMH battery data [34] is used as another type of battery for comparison. The goal is to investigate the possibility of Li-S cell SOC estimation using the existing classical methods in the literature. 
For this purpose, an equivalent circuit battery model, called “Thevenin model” [33] or one RC network model (1RC model), is used as illustrated in Fig. 4(b). 
In this structure, Vt is battery’s terminal voltage, VO C is OCV, RO is internal resistance, RP and CP are equivalent polarization resistance and capacitance, respectively.
Using the above differential equations, an observability analy-sis would be possible by considering a state-space representation of the model
Li-S cell’s internal resistance and OCV are obtained for the experiment described in previous section (see Fig. 3). Referring to Fig. 1, the Li-S SOC range can be divided into two parts, usually referred to as the “high plateau” (HP) and “low plateau”(LP).  There is a breakpoint at around 75% SOC that determines the boundary between the two plateaus. 
We can then form the observability grammian for our system. As we have one dynamic state Piecewise linear approximation of OCV-SOC curves. (a) NiMH.
If we consider a battery model where the only parameter that is estimated is the open-circuit voltage (Vo c )
It is demonstrated in the literature that battery’s performance is a function of different factors such as SOC, state of health (SOH) [36], and temperature. So gener- ally cell’s parameters are functions of those variables as follows:
The battery parameters are obtained by using the system identiﬁcation algorithm and, then a nonlinear function like g , in following equation, (i.e., ANFIS) is utilized for SOC estimation:
Unlike coulomb-counting, it can start from any initial SOC value and no initial condition data are needed to run the estimator. Unlike coulomb-counting, the whole battery capacity is not needed for SOC calculation. Unlike recursive adaptive ﬁlters, no time is needed for convergence of the algorithm at the beginning. The proposed method is simple and fast enough to be used in real-time applications. In addition, ANFIS models are adaptive and can be retuned very fast.
A hybrid learning approach is used, combining the gradient-descent method with the least squares estimate to tune ANFIS parame-ters. 
Even for one cell, the break point’s location and total capacity can change due to variation in temperature, discharge rate, etc., which make Li-S battery SOC estimation a challenging task. 
The power demand signal was, then, scaled-down to be applied to a single cell. Since the Li-S cells used in this study are prototypes; 
Aver-age power of a single Li-S cell, which is used in this study, is about 5 W. Assuming a maximum power demand of 60 kW in a typical EV to move based on UDDS drive cycle, 12 000 of these prototype Li-S cells are needed. 
Like the pulse discharge test explained in Section II, current and terminal voltage were recorded at sampling rate of 1 Hz.
A scaled-down current proﬁle is depicted in Fig. 14(b) in which the maximum current is around 1.2 A. Keeping same ratios, all current values can be scaled up and down to investigate differ-ent currents levels as well. In our tests, the maximum current was not more than 2.4 A. 
Another problem is that the battery capacity (Ct ) might change under various conditions, which can lead to errors when using coulomb-counting.Shift in the breakpoint between high-plateau and low-plateau around 75% SOC: this can happen due to temperature change, high discharge rate, ageing, etc., and leads to an error in SOC estimation between 65% and 85% SOC.
At high-plateau (from 100% SOC to the breakpoint around 75% SOC), OCV changes a bit in response to temperature variations.
An observability analysis demonstrated that the Li-S cell’s ECN model is not observable unlike Li-ion or NiMH battery types. 
This result, which is due to the ﬂat shape of OCV-SOC curve of a Li-S cell, makes it more challenging than other battery technologies to be estimated and controlled.
For the ﬁnal application of the study in an automotive energy storage system, the tradeoff between accuracy and speed (i.e., low-complexity) should be explored to ﬁnd the best compromise.
One of the drawbacks of black-box intelligent approaches like ANFIS is that they need a large quantity of training data, which is sometimes not easy to obtain. 



 
A number of tests were conducted at different temperature and current levels. Fig. 15 demonstrates Li-S cell parametrization at 30 degree C during three complete UDDS tests. 
In Fig. 17, Li-S cell SOC calculation using coulomb counting and the hybrid technique are illustrated over UDDS test at 30 degree C. The test started from 80% SOC, but the initial value was not provided to any of the algorithms. Since the estima- tion algorithms do not know about the initial condition, both are started from 50% SOC.  As demonstrated in the ﬁgure, the hybrid technique is able to converge to a close bound around the right value of SOC by using ANFIS capabilities. 
Three temperature values, 15 degree C, 20 degree C, and 30 degree C, are investigated in this study. Fig. 19 demonstrates the effect of temperature on Li-S cell model parametrization.
In our practical application, the BMS regulates the battery C around a set point of 25 degree C. 
For example, assuming a set point of 25 degree C, three separate estimators could be trained at 20 degree C, 25 degree C, and 30 degree C. 
The measurements available include time, temperature, current, and terminal voltage. In Fig. 3, cell measurements in- cluding load current (input) and terminal voltage (output), which are recorded at 25 degree C, are shown for an experiment.