Various modeling techniques are used to predict the capacity fade of Li-ion batteries. Algebraic reduced-order models, which are inherently interpretable and computationally fast, are ideal for use in battery controllers, technoeconomic models, and multiobjective optimizations. For Li-ion batteries with graphite anodes, solid-electrolyte-interphase (SEI) growth on the graphite surface dominates fade.
This fade is often modeled using physically informed equations, such as square-root of time for predicting solventdiffusion limited SEI growth, and Arrhenius and Tafel-like equations predicting the temperature and state-of-charge rate dependencies. In some cases, completely empirical relationships are proposed. 
However, statistical validation is rarely conducted to evaluate model optimality, and only a handful of possible models are usually investigated. This article demonstrates a novel procedure for automatically identifying reduced-order degradation models from millions of algorithmically generated equations via bi-level optimization and symbolic regression. Identified models are statistically validated using cross-validation, sensitivity analysis, and uncertainty quantification via bootstrapping. 
On a LiFePO4/Graphite cell calendar aging data set, automatically identified models utilizing square-root, power law, stretched exponential, and sigmoidal functions result in greater accuracy and lower uncertainty than models identified by human experts, and demonstrate that previously known physical relationships can be empirically “rediscovered” using machine learning.
The simultaneous decrease of cost and increase of performance of lithium-ion batteries (LIBs) in recent years 1,2 has expanded their use from a longtime market niche of portable electronics to new markets, predominantly electric vehicles and stationary energy storage systems. These new markets require LIBs to achieve long lifetimes while still meeting performance requirements. 
For example, the profitability of stationary energy storage systems is often dependent on their lifetime; revenue can be generated by delivering energy as long as the batteries are still useful, but LIBs degrade both over time and as a function of energy throughput, eventually requiring replacement, which is capital-intensive and costly. 
LIB degradation varies substantially based on environmental conditions and use case, making it challenging to estimate the degradation cost and system profitability. At the root of estimating degradation cost is estimating the state-of-health (SOH) of a cell, which is some measure of the cell performance relative to its initial state. 
It is possible to simply measure battery SOH, but this approach is not predictive; a predictive model is required to estimate the future state of the battery from its present state. Predictive models enable battery controllers to optimize for long cell life or for project planners to estimate cost of cell degradation as part of technoeconomic analyses.
Predictive models for battery lifetime can be loosely categorized into empirical, semi-empirical, and electrochemical models. Empirical and semi-empirical models are models that predict capacity fade without any simulation of the internal physics; this includes reducedorder models,10–24 which are simply algebraic equations, as well as machine-learning based approaches. 
For this application, the key difference between these approaches is their interpretability; low dimensional algebraic models are straightforward to interpret, as observed behaviors can be attributed to the various components of an equation, while machine learning models can be challenging to draw physical interpretations from Refs. 29, 30.
Semi-empirical models attempt to address the challenge of identifying algebraic models that are safe to extrapolate when trained on very small data sets by incorporating physically informed equations, usually simple chemical or electrochemical reaction models such as the Arrhenius equation, incorporating domain knowledge to counteract a lack of data; recent work, however, has shown that this widely used approach may not be analytically or statistically valid. Electrochemical models, which numerically or analytically simulate the internal physics of a battery, are inherently interpretable but are usually too computationally intensive to predict degradation over tens of thousands of hours. Recent work by Reniers et al. 
However, these models are still much more computationally intensive than the algebraic expressions used by reduced-order models, and are challenging to properly parameterize, making them powerful tools for experts, but difficult to apply quickly when experimental data is limited. The flexibility to handle both small and large training data sets, fast computation, and ease-of-implementation inherent to algebraic reduced-order models naturally lends them to use many complex optimizations, where implementing numerical electrochemical models may be computationally prohibitive.
The main challenge of utilizing a reduced-order battery lifetime model is in identifying an algebraic expression that predicts cell behavior accurately and extrapolates safely. This process is challenging for even the simplest battery degradation mechanisms. 
This is because the capacity fade for common LIBs during calendar aging is dominated by a single degradation mechanism, the growth of the solid-electrolyte-interphase (SEI) atthe graphite electrode, and the only experimental variables are time, ambient temperature, and cell state-of-charge (SOC).
This source of capacity loss is often categorized as the loss of lithium inventory (LLI). Even for this simple case, a litany of models exists. Often, model identification is informed by known physical relationships, such as individual cell fade models assuming t0.5 behavior, which models SEI growth when it is rate-limited by the diffusion of neutral lithium through the SEI,35–37 or SEI growth rate models based on Arrhenius or Tafel equations.
Additionally, because reduced-order models are being used to model complex systems with competing internal processes, rather than the simple systems used to derive most physically informed models, these models may not even be analytically supported. This is not to suggest that physically informed models cannot be utilized, only to highlight the need for statistical validation of any reduced-order model. 
And, in lieu of effective physically informed equations, a statistically rigorous methodology for empirically deriving reduced-order models needs to be presented. Empirically derived and physically informed models can then be compared to clarify the advantages or disadvantages of both approaches; presenting such a method and comparing the results with prior best-practices is the purpose of this work.
duced-order capacity fade models for LIBs is presented, implementing a variety of statistical techniques to interrogate and validate models. Multiple model types to describe cell capacity fade are compared to identify an optimal model: square-root, power law, stretched exponential, and sigmoidal models. For each model, several variations are tested, where for each variation, certain parameters are optimized locally to each individual cell of a data set and others are optimized globally across the entire data set. This is done simultaneously via bi-level optimization, which is also be referred to as nested optimization. 
Sub-models that predict the values of local parameters as functions of cell operating conditions are then automatically identified via symbolic regression, which selects a low-dimensional sub-model from over one million possible combinations utilizing LASSO regularization38 on an algorithmi cally generated library of possible descriptors. This sub-model then replaces its corresponding local parameter, constructing a global model, which is a single equation describing the behavior of the entire data set. Global model quality is investigated using crossvalidation, convergence analysis, sensitivity analysis, uncertainty quantification, and extrapolation.
On a standout experimental data set monitoring calendar aging of 22 commercial LiFePO4 (LFP)/Graphite cells for about 8 months,18 a range of automatically identified models outperform the physically informed t0.5 model structure commonly used in the literature, with substantially lower error, less evidence of systematic deviation between model predictions and data, and lower uncertainty. 
 Predictions by various models of the capacity fade after 20 years of aging imply that t0.5 models may be overpredicting capacity degradation by almost 100% at long times, when compared with more accurate power-law or sigmoidal models.
The approach shown here for automatically identifying reducedorder models can hopefully be used to explore the implications of predictive model accuracy on the conclusions of technoeconomic models or battery controllers, rapidly develop accurate models to predict and compare the degradation behaviors of multiple Li-ion technologies, and also accelerate learning from new experimental data sets. 
This work builds on a growing amount of literature utilizing compressed sensing methods, such as symbolic regression, for harnessing the advantages of machine-learning in a scientific context.
Reduced-order models of individual-cell capacity fade.New research on calendar fade mechanisms in Li-ion batteries, specifi-cally on batteries using graphite intercalation anodes, has brought issues to light with the historical approach of modeling the calendar fade of individual cells using a t0.5 dependence for capacity loss. This t0.5 dependence is born from assuming that LLI due to SEI growth on graphite is rate-limited by diffusion of neutral lithium through the SEI after the first few formation cycles have been completed.
Thus, the t0.5 model is not necessarily validated as a general model from an analytical standpoint. This conclusion is doubly true for studies modeling calendar fade in full cells, which experience separate cathode effects during aging, or calendar fade models for LIBs using other anode materials.41 Empirical analysis also contests the suitability of t0.5 models for predicting calendar fade of lithium-ion batteries with graphite anodes. 
This includes the square-root of time model, various power law models, logarithms, stretched exponential, and sigmoidal models. Logarithm models are useful for modeling a wide variety of systems but are difficult to physically interpret in this context and are not considered in this work.
Stretched exponential models have been used to model decay of the dielectric constant of polymers and glasses with time,44,45 and in the context of LIBs, have been used to model both calendric and cyclic capacity loss.42,46,47 Sigmoidal type models have been used to model bacterial growth/survival48 and more recently chemical reaction kinetics,49–52 and were proposed for modeling LIB capacity fade by Gering.
Reduced-order models of rate dependence on cell operating conditions.—Predictive models for battery degradation are most useful for control algorithms or technoeconomic analysis when they predict battery performance across a wide range of environmental conditions and use cases. One path to constructing such a model is to predict the variation of parameters from individual cell models, i.e., local models, as a function of each cell’s operating conditions.
Local models can be constructed with any time-varying experimental variables as the input (time) or the predicted response (relative capacity). After applying Eq. 1 to each two-dimensional data series within a data set, the values of β1 from each cell can be combined into a one-dimensional vector, β1. A global model is then formed by identifying some function that predicts the variation of β1 across the data set as a function of any time-invariant experimental variables (temperature and SOC).
Various other models have been proposed for predicting the calendar fade rate of LIBs with graphite anodes in the literature. These models are shown in Table II. Even when only modeling temperature effects, various models have been proposed (Eqs. 5 and 6). For incorporating the additional impact of cell SOC on degradation rate, several different input features have been proposed: Ua (Eqs. 7 and 8), SOC (Eqs. 9–12), and the full cell potential V (Eqs. 13 and 14). These models also propose widely varying structures, such as multiplicative models (Eqs. 3, 5, 11, 14), linear combinations of complex descriptors (Eqs. 9, 12, 13), and non-linear models (Eqs. 6, 7, 8, 10). 
Include cross-validation to estimate model predictive quality: Cross-validation is conducted by iteratively training a model on portions of the data set and calculating the prediction error on the held-out data. Cross-validation is a first step when evaluating the predictive quality of a model, and is complemented by other methods demonstrated in this work: testing models against unseen validation or extrapolation data sets, quantifying model sensitivity to its inputs, and quantifying model uncertainty.
 Three steps are involved for optimizing each model: 1) Use bi-level optimization to simultaneously regress both local (β) and global parameters (α) to each cell’s data series across a data set, 2) automatically identify and regress sub-models for each local parameter, and 3) assemble the global model by replacing local parameters with their respective sub-models and regressing. Any interesting or promising models are then interrogated in step 4) via sensitivity analysis, bootstrap resampling, and extrapolation over long times and to unseen validation data.
Generation of the descriptor libraries was conducted according to a procedure inspired by prior works.71,75 For modeling the calendar aging of lithium-ion batteries with graphite electrodes, the salient input features are ambient temperature, SOC, and Ua, which were separated into two groups: temperature related, and voltage related. Next, several operators were defined for generating descriptors.
The unary operators used in this work to modify any feature X are X0.5, X2, X3, X−1 , and eX. Binary operators combine two features or descriptors from different groups and create a new group. The only binary operator used in this work is element-wise multiplication of two groups, XA · XB.
Down selection of descriptors from the generated libraries was conducted using the MATLAB function lasso, which implements LASSO ℓ1-norm regularization. The LASSO algorithm requires the input of a hyperparameter, λ, which sets the magnitude of the penalty imposed on the number of non-zero model parameters. In this work, λ was optimized by a grid-search over logarithmically spaced values with 200 points between 10−6 and 100 . Model error at  using 4-fold cross-validation. LASSO was used not to find the model with the lowest possible MSECV, but rather to find the model with the fewest parameters that has MSECV equal to the lowest MSECV plus one standard deviation, referred to as the “1SE” model in the MATLAB documentation.
This was done because the lowest MSECV model often contains many parameters, but lower-dimensional models are preferred for this work to aid interpretability and avoid over parameterization. The MATLAB function lasso can also implement the elastic-net regularization algorithm, which can help balance model sparsity with tolerance to noise or correlated input data; elastic-net was not used here due to the complexity of finding the optimal values for two hyperparameters, but will be considered in the future, along with other sparse regression algorithms.
After identification, the behavior of local parameter sub-models was investigated by cross-validation and bootstrap resampling. NLLS optimization utilizing the Levenberg-Marquardt algorithm via the MATLAB function nlinfit was used for calculation cross validation error and quantifying model uncertainty via bootstrap resampling.
Global model optimization and interrogation.—A global model is created by replacing each local parameter with its respective submodel, forming a single equation that predicts the capacity fade of for the entire data set. Global models were optimized using NLLS fitting utilizing the Levenberg-Marquardt algorithm via the MATLAB function nlinfit. Cross-validation error was calculated using leave-one-out cross-validation on a cell-by-cell basis. 
Sensitivity analysis was conducted by adding Gaussian random noise to each input vector, optimizing the model on the noisy data, and normalizing the MSE of the model trained on noisy input data by the MSE of the unperturbed model. 
Train, validation, test, and extrapolation data sets.—The data set used in this study was previously published by Schimpe et al.18 Their work reported calendar aging data from 22 commercial LFP/ graphite 26650 format cells (Sony US26650FTC1). Cells were calendar aged at temperatures of 10 °C, 15 °C, 25 °C, 35 °C, 45 °C, and 55 °C, with SOC variation at 15 °C and 45 °C between 0%, 12.5%, 25%, 37.5%, 50%, 67.5%, 75%, 87.5%, and 100%. Cells at other temperatures were stored at 100% SOC. Cell discharge capacity was measured during a reference performance test (RPT)  procedure using a CC–CV discharge (1C, C/50 cut-off). 
Four model types (square-root, power law, stretched exponential, and sigmoidal) were used to create fifteen distinct models to investigate in this work, detailed in Table IV. Square-root and power law models are widely used throughout the literature. Stretched exponential models contain one more parameter than power-law models, and have a constant bound at positive infinity, ensuring the model will not extrapolate to infinitely large degradations. 
Sigmoidal models have the same number of parameters and the same qualitative behavior as stretched exponential models but have constant bounds at both positive and negative infinity, so they may behave differently.
The behavior of the sigmoidal model, which demonstrates the best performance of any model investigated, is then thoroughly interrogated. The convergence behavior of investigated models is analyzed to determine which features of the data set are learned during training. The impact of input feature selection on the resulting model behaviors is analyzed by comparing power law and sigmoidal models after training with and without Ua as an available feature.
Model convergence behaviors.—The convergence of models to a global minimum when trained on increasing amounts of data is explored here, both in the time dimension as well with respect to the number of test conditions. Convergence of models with respect to test time is investigated by training several model types on
increasing numbers of RPTs. Convergence of models with respect to the test conditions is investigated by training the power law model on increasing numbers of cells. In both cases, models using machinelearned sub-model equations are compared directly with models using human-expert defined sub-models.
Thus, inspired by recent work of Attia et al.,10 recommendations for statistically validating reduced-order capacity fade models were presented, and these recommendations were demonstrated by comparing physically informed and semi-empirical models found in literature to those constructed empirically by an automatic identification procedure utilizing bi-level optimization followed by symbolic regression. Models using power law, stretched exponential, and sigmoidal type equations were trained on a standout calendar aging data set of LFP/graphite cells published by Schimpe et al.
Statistical techniques of cross-validation, convergence analysis, sensitivity analysis, uncertainty quantification by bootstrap resampling, and extrapolation were utilized to interrogate the behavior of the studied models. The best fitting model, a sigmoidal model, predicted the relative capacity fade of the training data with approximately half the MAE of a semi-empirical model identified by a human-expert. The sigmoidal model reported here also extrapolated more accurately to validation data and showed muchlower predictive uncertainty. 
 The automatic identification procedure also found models with square-root, power law, and stretched exponential structures that had improved performance relative to human expert models were also identified, demonstrating the flexibility of this method for identifying robust models regardless of the chosen structure.
Models identified using the machine learning empowered approach shown here are more readily comparable, as the search for best model is algorithmically defined, and thus long-term predictions can be analyzed with confidence that comparisons between models trained on different data sets are fair. 
Regardless of the model structure, quantification of uncertainty can be used to guide the design of future experiments, and rigorous statistical interrogation of models can speed the discovery of underlying physics of complex systems by ensuring that as much information as possible is learned from the available data. And while the focus of this article is on capacity loss governed by a single degradation mechanism, the approach herein is applicable to other battery health metrics such as cell impedance rise, as well as to more complex data sets that demonstrate multiple degradation mechanisms.

