A response from an electrocatalytic gas sensor contains ﬁngerprint information about the type of gas and its concentration. As a result, a single gas sensor can be used for the determination of different gases. However, information about the type of gas and its concentration is hidden in the unique shape of the current–voltage response and it is quite difﬁcult to explore. One of the ways to get precise information about the measured gas is to use multivariate data analysis and pattern recognition techniques. In this paper we present the results of an investigation based on a combination of the cyclic voltammetry measurement technique and chemometric analysis methods such as principal components analysis, linear discriminant analysis and the k-nearest neighbors algorithm classiﬁer for distinguishing different types of toxic gases. The responses of the single electrocatalytic gas sensor to 20 ppm of ammonia, nitrogen dioxide, sulfur dioxide and various concentrations of hydrogen sulﬁde in balance with synthetic air have been measured and analyzed. The reduction of measurement points in the data set used for multivariate analysis was evaluated.

Electrocatalytic gas sensors belong to a group of solid-state electrochemical gas sensors [1, 2]. Such sensors, operating in the cyclic voltammetry mode, have particularly interesting properties, since, in comparison with other electrochemical gas sensors, they show improved selectivity. Moreover, with proper excitation and in good operating conditions, they allow the measurement and determination of different types of volatile compounds with a single, simple sensor construction [3, 4]. The name electrocatalytic is a direct consequence of their sensing mechanism, i.e. the electrochemical reactions that are electrically catalyzed. These sensors are still under development and their sensing mechanism continues to be clariﬁed [5]. So far only a few different structures have been investigated [6–8], among which the sensors with Nasicon as the solid electrolyte seem to be the most promising [4, 9].

The electrocatalytic gas response contains information about the type and concentration of the measured compound. Namely, in the current–voltage (I–V) plot characteristic peaks due to electrochemical reactions are visible. However, the information about the type and gas concentration of the chemical cannot be obtained in a direct and simple way. So far only a few methods of analysis for the response have been proposed. One utilizes the feature that the concentration of a measured gas can be related to the area under the peak [6]. This analysis is based on the fact that the area under the peak is related to the amount of charge which takes part in the electrochemical electrode reactions. In the other method, by analogy to cyclic voltammetry in wet electrochemistry, the height of a peak at a speciﬁc voltage is used for analysis [10]. In this case, the value of the maximum electrical current can be related to the gas concentration, while the voltage of the peak can be associated with the type of gas. The most promising way of obtaining information about the type of measured compound for these sensors seems to be the application of multivariate data analysis and a patternrecognition technique. These methods assume that the shape of an I–V plot is an indication of the sensor response. Feature extraction techniques, like principal component analysis (PCA), can be performed to obtain the classes of single volatile compounds. The classes given by the feature extraction are projected into the discriminant plane, and then the patternrecognition techniques can be used for classiﬁcation. The analysis approach based on multivariate methods and pattern recognition of electrochemical sensors has been used for the detection and determination of both volatile and liquid compounds [i.e. 11–15]. However, the use of chemometric methods to utilize responses from a single electrocatalytic gas sensor is still insufﬁciently studied. For example, identiﬁcation of the most signiﬁcant range of I–V responses is foreseen, in order to reduce the data set for multivariate analysis. In this paper the multivariate methods are used for the analysis of the responses from a single electrocatalytic gas sensor. This approach involves the use of multivariate data analysis and pattern recognition techniques on the responses from a single sensor for the determination of four environmental gaseous compounds—ammonia, sulfur dioxide, nitrogen dioxide, hydrogen sulﬁde. In this preliminary study, the applicability of chemometric methods was investigated for the analysis of the responses from an electrocatalytic gas sensor.

Responses from a single concentration (20 ppm) of ammonia, nitrogen dioxide, sulfur dioxide were investigated together with three different concentrations (4, 10 and 20 ppm) of hydrogen sulﬁde. The PCA method was performed on the data for feature extraction, while for classiﬁcation the linear discriminant analysis (LDA) method and the k-nearest neighbors algorithm (k-NN) were used. For the purpose of data set reduction in multivariate analysis, selected parts of the I–V plot were analyzed for having the most signiﬁcant information.

Nasicon (chemical formula Na2.8Zr2Si1.8P1.2O12) powder was prepared using a conventional solid-state ball milling method [16]. A mixture of chemically pure Na2CO3, ZrO2, SiO2 and (NH4)2HPO4 was milled several times and then calcinated at 900 C. White, ﬁne-grained powder was obtained. Pellets in the form of discs of 12 mm in diameter and 1 mm thick C. were prepared by iso-axial pressing and sintering at 1200 Electrodes were made by coating the opposite pellet sides with a platinum paste (ESL 5542) and then by ﬁring at C. The prepared sensor structure is shown in ﬁgure 1. The 900 measurements were conducted in synthetic air and in 20 ppm of ammonia, sulfur dioxide, nitrogen dioxide or hydrogen sulﬁde. All gases were obtained premixed with synthetic air (Linde Gas). Mass ﬂow controllers were used for obtaining the desired concentration of each gas. During the measurements −1 was maintained. a constant gas ﬂow of 100 cm3 min The sensor was placed in a tube furnace. For electrical measurements the electrochemical interface Solartron SI 1287 was used. The sensor was excited with a symmetrical triangular voltage having an amplitude of ± 5 V and a sweep rate of −1. All results presented in this work were obtained 50 mV s from a single sensor at an operating temperature of 300 C.

The measurements were conducted according to the following procedure. Before measurements were taken, the sensor was subject to the regeneration procedure [17]. During this procedure the sensor was operated for 40 cycles in the presence of synthetic air (SA). Meanwhile the temperature was changed from 300 C. This procedure ensures that the sensor’s ‘history’ does not inﬂuence the current measurement. After the process of regeneration, the sensor’s response in synthetic air at 300 C was stable and almost identical to sensor responses obtained previously using the same conditions. After each regeneration the sensor was exposed to one of the selected gas compositions, in the following order—10 ppm H2S, 4 ppm H2S, 20 ppm H2S, 20 ppm NH3, 20 ppm NO2, 20 ppm SO2; and when the response had been stabilized (usually after 10 cycles), the measurements used for further data analysis were performed and I–V responses collected.

A collection of sensor responses in the form of current–voltage plots was obtained. The response for each analyte was stored in a separate text ﬁle which contained a set of voltammograms. For further analysis, I–V curves were separated using software written in MATLAB and, as a result, a single I–V cycle analysis without losing classiﬁcation quality. Understanding which parts of the acquisition data are insigniﬁcant provides the opportunity to perform analysis more efﬁciently. Schema A dealt with the original 200 values, while schema B and C with only 100 values related to voltage increase (from −5 to 5 V) and voltage decrease (from 5 to −5 V), respectively. Schema D was associated with only 36 values of a speciﬁc voltage excitation range. The selection of this speciﬁc voltage range will be described later in detail.

(single acquisition) has been extracted. Acquisitions obtained in this way were used to create a multivariate data set of acquisitions. Table 1 summarizes the available acquisitions used for multivariate analysis. The number of all acquisitions (single I–V plots) for each gas is presented together with the number of target classes for discrimination and classiﬁcation purpose. The available acquisitions have been divided into a training and test set according to the following criterion: the initial 50% of the acquisitions for each of measured gas was used as a training data set, while the other 50% of the acquisitions was used for testing. The training set was used for creating the discriminant model, while the test set was used for validation [18]. The structure of the training and test sets is shown in table 1.

To standardize from each I–V measurement cycle (more than 4000 measurement points) only 200 values of current were selected for analysis. Thus, each acquisition contained 200 features. The ﬁrst value corresponded to 0 V, while every subsequent value corresponded to a voltage of 0.1 V higher or lower depending on the ramp direction. In this way the ﬁrst 50 points corresponded to the voltage range from 0 to 5 V, the next 100 points to the voltage range from 5 to −5 V, while the last 50 points to the voltage range from −5 to 0 V. The resulting training and test multivariate sets dimensions were the same, and equal to 90 × 200. Each row contains one acquisition (one I–V cycle), while each column contains the values of current. In the presented study, the entire analysis is performed on raw (i.e. without any preprocessing procedures) data. Utilizing preprocessing techniques on voltammetric measurements is a common procedure [19]. However, there are also reports in which analysis was performed on raw, untreated data [20]. The purpose of this study is to investigate the possibility of simplifying the analysis procedure. Namely, obtaining satisfactory results from raw data, which would lead to the determination of the measured compound using data directly from the measurement system.

Four different analysis schemas were performed on all 90 training and 90 test acquisitions. In these schemas the acquisition size was altered in order to investigate the inﬂuence of input data reduction on classiﬁcation quality.

For the initial analysis of the obtained acquisitions, the PCA method was used. PCA is commonly used in the ﬁeld of gas sensors analysis. Using this method it is possible to reduce the dimension of data and present it in a more compact and clear way in the space deﬁned by the principal components. The number of principal components (PCs) is equal to the number of describing variables in the input data, but usually the ﬁrst few PCs are to explain most of the variance in the original data. The PCA converts the input data X into the product of two matrices—score Q and loading P, according to the rule: X = QPT. The score matrix contains vectors which describe the direction of the principal components in relation to the observations, while the loading matrix is a set of loading vectors which describe the direction of the principal components in relation to the original variables. The major (mostly ﬁrst and second) loading vectors provide information about the signiﬁcance of the original variable in the data set [14, 21]. In this study, the ﬁrst and second loading vector will be used to obtain information about the signiﬁcance of the voltage excitation range (and corresponding current responses) in the data set. In general, the larger the loading values are, the more signiﬁcant the voltage excitation values are to the analysis. This information will be used for data set reduction without losing classiﬁcation performance. Both score and loading matrices were used to analyze the obtained electrocatalytic the observations into the score plot is used for data classiﬁcation [14].

Two methods of classiﬁcation were used for distinguishing measured gases: the LDA and the k-NN. LDA is a supervised technique, which is commonly used for feature extraction. The method maximizes the variance between classes and minimizes the variance within them. It is a statistical method that could determine to which group the samples belong. The LDA is not strictly a classiﬁcation method. However, it can be turned into a classiﬁer by estimating the linear discriminant functions to separate the classes [22]. In the presented study we utilize the LDA for the determination of gaseous compounds based on the extracted information represented by PCA scores, i.e. the scores which were used as inputs for the LDA classiﬁer [23].

Another method used for classiﬁcation is the k-NN algorithm. This tool enables the recognition of objects based on their close proximity in the feature space. An object is assigned to the class most common amongst its k-nearest neighbors. This algorithm does not require the training stage since it operates only on the distance between the points in the feature space. In this study, the feature space is based on the PCA scores. The 1-NN (one neighbor) and the 3-NN (three neighbors) algorithms were used, and the Euclidean metric distance was applied. The data analysis was performed using MATLAB (Mathworks, Inc.). The PCA, LDA and k-NN routines present in Statistics Toolbox have been utilized.

Typical sensor responses for each of the measured toxic gas and synthetic air are shown in ﬁgure 2. The voltammograms that are related to the sensor response in the presence of 20 ppm of sulfur dioxide and 20 ppm of hydrogen sulﬁde have the highest peaks, but these are also asymmetric. The other responses, 20 ppm nitrogen dioxide, 20 ppm ammonia and synthetic air, have lower peaks but are more symmetric. What is important though, is that all responses have different characteristic features (the position and height of the peak), which can allow successful distinction using the PCA method. In ﬁgure 3 the voltammograms related to the sensor responses from different concentrations of hydrogen sulﬁde are shown. It can be seen that the position of the peaks in the I–V sensor responses are different for different concentrations and the height of the peak rises with the concentration increase of the measured gas. For further analysis I–V characteristics were transformed into vectors of 200 discrete values. An example of such a vector, which is in fact a single acquisition for the schema A, is shown in ﬁgure 4. The parts of this vector, which are used for the analysis described as schemas B–D, are also visualized in ﬁgure 4.

The preliminary analysis using the PCA method was performed on the training set, which contained the collection of acquisitions with all 200 values (schema A). The percent of variance explained in the data by individual principal components has been calculated. The results are presented in table 2. The ﬁrst two PCs explain 91.52% of data variance and contain the most information. This feature also reﬂects the ﬁrst (PC1) and second (PC2) loading vectors. Therefore, these vectors can be used to obtain the voltage excitation range, which provides the most signiﬁcant current values in the data set for feature extraction. Namely, a plot of values of the ﬁrst two PCA loadings, absolute values and normalized values, as a function of voltage excitations was prepared and presented in ﬁgure 5. A threshold line at 0.5 was marked in this plot (see ﬁgure 5) and the points of the ﬁrst and second loading vector above the threshold line were used to select the most signiﬁcant voltage excitation range. The voltage range from ± 1.5 to ± 3.2 V obtained in this way was used for the analysis in schema D and allowed the reduction of the acquisition vector from 200 to 36 measurement points. This reduction could be particularly useful in air-contaminants monitoring systems, where the calculations are conducted by a microprocessor unit in their working environment. Summarizing, four discriminant schemas were constructed and used in the analysis: the 200 measurement points of I–V plot (schema A), the currents related to increasing voltage excitation −5 to 5 V (schema B), the currents related to decreasing voltage excitation 5 to −5 V (schema C), and the currents related to the voltage range ± 1.5 to ± 3.2 V (schema D).

The PCA analysis was performed on the training set. The plane deﬁned by PC1 and PC2 was used as a model, on which the test set was projected. In all schemas, the classiﬁcations using LDA, 1-NN and 3-NN methods were conducted by projecting the acquisitions of the test set on the discriminant plane, which was deﬁned by the ﬁrst and second PC obtained from the appropriate training set. The comparison of classiﬁcation performance shown in this paper indicates not only the possibility of distinguishing measured gases, but also the inﬂuence of reducing the original acquisition to the set of values that gives the most information about the kind of volatile compound detected.

In ﬁgure 6 the results of projecting the scores of test and training data are presented. One may see that the projections representing synthetic air (SA), nitrogen dioxide and ammonia are tightly grouped together. The sensor responses for those gases are repetitive, and the compounds are clearly distinguishable. Projections related to sulfur dioxide and hydrogen sulﬁde are more spread out in the principal components space. They seem to be less repetitive, which may induce classiﬁcation errors. The responses for different concentrations of hydrogen sulﬁde are the most spread out in the PCs deﬁned plane. It can be seen that projections of 4, 10 and 20 ppm of H2S are located in different parts of the PCA plot. Despite this fact, the different concentrations of H2S form a cluster, which enables the recognition of this type of gas. The best classiﬁcation performance was achieved using 3-NN and LDA methods. Namely, all samples were classiﬁed correctly. The 1-NN method gave a 98.89% correct classiﬁcation. The overall classiﬁcation results (for all schemas) are shown in table 3. The achieved performance was treated as a reference for the other analyses. (b) Schema B: classiﬁcation based on acquisitions containing values connected with the voltage from −5 to 5 V, each acquisition containing 100 points.

The classiﬁcation procedure was the same as in the case of the schema A analysis. Similarly as for schema A (ﬁgure 6), the projections representing SA, NO2 and NH3 are also grouped very closely together, unlike projections representing SO2 and H2S. The percentage of correct classiﬁcation obtained for the LDA method was 94.44%, for the 3-NN method 94.44%, while for the 1-NN 100%. The 1-NN method provided improved classiﬁcation results in comparison with schema A, while the dimensions of the data set were reduced by half. However, using the 3-NN and LDA classiﬁcation the results were slightly worse. In general, it is possible to the voltammogram (schema D). These classiﬁcations were the same as for the reference analysis performed on the whole voltammogram (schema A). All classiﬁcation methods applied for determining the type of toxic compounds provided satisfactory results, however the most efﬁcient method was 3NN classiﬁer. Except for schema B, the 3-NN method provided 100% correct classiﬁcation.

The results obtained prove that the most signiﬁcant information about the type of gas measured using cyclic voltammetry can be extracted from PCA loadings. This information is contained in the data related to an excitation voltage from ± 1.5 to ± 3.2 V. In laboratory conditions there is no need to reduce original acquisitions. However, in realtime systems, it is an advantage to select only a few, important values for analysis due to the limited hardware resources and speed of calculations needed to compute pattern-recognition algorithms.

What is important, in all cases it was possible to classify correctly all acquisitions related to the synthetic air, 20 ppm of NO2 and 20 ppm of NH3. In the PCA plots it was seen that both training and test sets have created very distinct clusters. It means that sensor responses for these compounds were repetitive and reliable. In most cases only a few classiﬁcations of SO2 and H2S were incorrect. Those acquisitions in spaces deﬁned by PC1 and PC2 on PCA plots were scattered enough to generate misclassiﬁcation errors. However, it has to be mentioned that the sulfur-containing compounds, especially H2S, provided less repetitive I–V responses in comparison with synthetic air, NO2 and NH3. Therefore, the results obtained with generic pattern-recognition methods are very promising.

Electrocatalytic gas sensors are simple, low-cost devices which potentially allow the simultaneous measurement of various kinds of volatile compounds. The investigated electrocatalytic gas sensor based on a Nasicon solid electrolyte was exposed to ﬁve different types of gases—synthetic air, 20 ppm of nitrogen dioxide, 20 ppm of ammonia, 20 ppm of sulfur dioxide and three concentrations of hydrogen sulﬁde (4, 10 and 20 ppm). The sensor responses for measured gases were obtained using standard cyclic voltammetry with triangular voltage excitation. The possibility of precise differentiation between measured compounds was investigated using multivariate data analysis methods and pattern-recognition techniques. Four analysis schemas were investigated to check how the individual parts of the I–V plots determine the classiﬁcation results. The obtained results show that the application of the PCA with generic methods such as LDA and k-NN provides satisfactory classiﬁcation performance.

The results of reducing the range of signiﬁcant voltage excitation for electrocatalytic sensor measurements were also promising. It was proved that a signiﬁcant reduction of measurement points (schema D) does not degrade the performance of classiﬁcation. This observation can be treated as a useful tool in practical applications, where the necessity of fast and low computational costs is needed. Further work draw the conclusion that the upper part of the I–V plots contains slightly less information than from the whole I–V plots. However, the classiﬁcation using this part of I–V plot to distinguish the compounds measured by the electrocatalytic gas sensor. (c) Schema C: classiﬁcation based on acquisitions containing values connected with the voltage from 5 to −5 V, each acquisition having 100 points.

The results obtained are presented in table 1, they show that the analysis of the lower part of the I–V plots provides better differentiation between gases than with the methods used previously. This observation is justiﬁed by the obtained classiﬁcation results. When using the 3-NN method, all samples were correctly classiﬁed. The 1-NN and LDA provided a classiﬁcation level of 98.89%. Therefore one may conclude that for the investigated acquisition, the lower part of I–V plots provides more information for pattern-recognition techniques than the upper part. (d) Schema D: classiﬁcation based on the acquisitions containing values connected with the voltage from ± 1.5 to ± 3.2 V, each acquisition containing 36 points.

The most reduced analyzed acquisition contained only 36 selected measurement points from each I–V cycle. Namely, the 36 measurement points related to the excitation voltage from ± 1.5 to ± 3.2 V was analyzed. The PCA plot presented in ﬁgure 7 is visually very similar to the plot obtained in case of schema A (see ﬁgure 6). It suggests that signiﬁcant information about the type of gas and its concentration is present in the selected voltage excitation range. There is no signiﬁcant difference in the projections in comparison with previous analyses. In fact, the classiﬁcation results were the best among all of the tested schemas.

Although information about the type of gas and its concentration is present across the whole I–V plot, the results of the experiment conducted showed that the most satisfactory classiﬁcation was obtained on data from the selected part of on the possibility of precise estimation of the type of gas and its concentration is being investigated.
