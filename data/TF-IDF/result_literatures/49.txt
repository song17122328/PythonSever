Molecular dynamics (MD) is a powerful tool to investigate microscopic transport of atoms and molecules in condensed matter. However, there lies a large class of systems wherein atomic diffusion is too slow a process relative to the feasible time scales of typical atomistic simulations. Here we demonstrate that with judicial implementation of metadynamics (MTD) technique the microscopic mechanism of atomic transport in solids can be accessed within reasonable com-putational time. The calculations are carried out on the two end members of the true NASICON solid solutions, namely NaZr2(PO4)3 and Na4Zr2(SiO4)3, wherein the Na+ diffusion is too low to be accessed through standard MD simulations. The study also provides fresh insights on the cor-related ion hops and its implications on the effective diffusion barrier. The results are compared with climbing image nudged elastic band (CI-NEB) calculation, and available experimental results.
Over the last couple of decades molecular dynamics (MD) simu-lation has emerged as an extremely powerful tool to investigate physico-chemical processes in condensed states of matter.1,2 The technique renders the description of matter at the atomic length and time-scales, which are otherwise often inaccessible through experiments. MD simulations are now routinely employed across a variety of research ﬁelds, such as bio-physics, materials sci-ence, physical chemistry, etc. However, despite its popularity MD technique suffers from certain limitations pertaining to the length and time scales of the simulation. The ‘classical’ MD simulations (which employs predeﬁned interaction between constituent parti-cles) are capable of exploring systems typically of the size of sev-eral thousands of particles for over hundreds of nano-seconds,1,2 while its advanced counterpart namely, the ab initio MD simula-tions (which calculates the interatomic interactions ‘on the ﬂy’, based on density functional theory) can tackle only a few hun-dred atoms for a few hundred pico-seconds, at best.3–5 Thus both the variants of MD simulations leaves out very large number of process of interest, be it materials science related or of biological interest, practically outside of its ambit.Several methods have been proposed in the past to deal with such ‘rare events’, meaning the time-scales of the process of inter-est is much larger than the affordable simulation time-scales.6–12 Metadynamics (MTD) simulations, originally proposed by Laio and Parrinello,13 is arguably one of the most promising ap-proaches in this pursuit. MTD algorithm invokes standard MD, but additionally artiﬁces application of small external potentials or ‘hills’ to act on a select subset of degrees of freedom of the sys-tem (called ‘collective variables’) over regular intervals of time. This essentially results in ‘accelerating’ the event of interest to be observed within MD time-scales. Thus the method retains many a virtues of the standard MD and maintains minimal ‘bias’ in terms of the microscopic mechanism of the event investigated, but ad-mittedly at the expense of direct temporal information.Since its inception MTD approach has been successfully adapted to variety of problems of interest.14–22 Consequently the technique has evolved, with several improvements and modiﬁ-cations, providing prescriptions for its optimal implementation, balancing both efﬁciency and accuracy.12,23–30 Since Jug et. al.31 examining oxide ion transport in rutile (TiO2), a few more stud-ies employed MTD technique for investigation of transport incondensed matter systems, such as, proton transport in zirconia(ZrO2),32 Li transport in garnets (Li7La3Zr2O12),33 Cu diffusion in CuZr-alloys,34 and molecular transport in porous organic net-work solids.35
The present demonstration of the implementation of the tech-nique involves Na+ transport in one of the promising structural class of solid electrolytes, namely NASICONs (an acronym for Na Super Ionic Conductor). Solid electrolytes are of colossal concurrent interest for the development of all solid state bat-teries which promises high energy-density, along with better safety and low environmental footprint.36–41 Since their incep-tion by Hong42 and Goodenough et. al.43 NASICON solid so-lutions, Na1+xZr2SixP3-xO12 (where 0 ≤ x ≤ 3.0), have received protracted attention of materials scientists, due a variety of tech-nological applications, such as, in all-solid-state batteries, super capacitors, gas sensors, for packaging of electronic components, and as materials for nuclear waste conﬁnement.
The intermediate composition of this solid solution with x = 2,Na3Zr2Si2PO12, exhibits very high Na+ conductivity, and has been extensively studied, both experimentally as well as employ-ing MD simulations. However, the two end members of the family,NaZr2(PO4)3 and Na4Zr2(SiO4)3, exhibits much slower Na+ dif-fusion with respect to time-scales of MD simulation, thus serving as good prototypical candidates for the present MTD calculations.
Classical MD and MTD simulations on NaZr2(PO4)3 and Na4Zr2(SiO4)3 are carried out in the canonical ensemble (NVT) at 500 K, employing the Vashishta-Rahman form of the interaction potential,where qi and q j are the partial charges, σi and σ j are the ionic ra-dius of ith and jth species respectively. Ai j and Ci j are respectively the overlap repulsive energy and dispersion energy between ith and jth ions. Listed in Table 1, the potential parameters employed are taken from a previous study by Kumar and Yashonath.49,50The initial structure of the NASICONs are taken from the X-ray study of Boilot et al.51 The simulation box is made from 3 × 3 × 1 unit cells having rhomohedral (R3C) symmetry. The simulation super-cell thus includes a total of 972 ions (54-Na, 108-Zr, 162-P and 648-O) for NaZr2(PO4)3 and 1134 ions (216-Na, 108-Zr, 162-P and 648-O) for Na4Zr2(SiO4)3. The initial X-ray struc-tures51 of both systems are relaxed under isothermal-isobaric(NPT) ensemble at 500 K. The dimension of the relaxed simu-lation box are a = b = 26.989 Å, c = 22.672 Å for NaZr2(PO4)3 and a = b = 27.680 Å, c = 22.379 Å for Na4Zr2(SiO4)3. At an in-tegration time-step of 2 fs, the production run for NaZr2(PO4)3 was 100 ns long, while that for Na4Zr2(SiO4)3 was 200 ns long for better convergence of properties.Molecular dynamics that powers the MTD calculation, is carried out employing the software LAMMPS (Large-scale Atomic/Molecular Massively Parallel Simulator).52 MTD simu-lation of the system is invoked by interfacing PLUMED53 with LAMMPS. Our implementation of the techniques for the expedi-tion of the ion transport process in the systems employs coordinates of a single, arbitrarily chosen, Na+ ion, r¯s = (xs,ys,zs), as the ‘collective variables’ (CV ). The net external potential imposed on this tagged ion or ‘walker’ at any instant, t, is the sum of the Gaussian ‘hills’ deposited at regular intervals (100 MD steps in the present work), during the period of t = 0 to t = t', and is given by, where w is the width of the Gaussian, kept constant at a value of 0.35 Å. H(t') is the height of the Gaussian imposed at an MTD step, t = t'. In the ‘well tempered’ MTD formalism25 the Gaussian heights are tuned as, where T is the instantaneous temperature of the system, and ∆T = (γ − 1)T . The initial height H0 is chosen as 0.006 eV, and γ = 6 following Barducci et al.25 However, to validate the choice of γ we have carried out additional runs – with γ = 3 and with γ = 9. These results are summarized in Supporting Information (SI)†.Free Energy Calculation: One of the most useful information from MTD simulation is the mechanism of the process and its underlying free energy landscape. It shall be noted that the free energy of a ‘process’ (except for an insigniﬁcant additive term due to the reference state) as a function of CV (in the present case, the position of the tagged particle, r¯s), is given by,25
In the present work the free energy proﬁle for the Na+ along the migration channel is calculated by mapping the F(r¯s), as a func-tion of the distance of the location, r¯s, with respect to any two of its nearest Na1-sites, λ , under periodic boundary conditions. Note that the mapping of the F(r¯s), from space coordinates, r¯s, to F(λ ), is in the spirit of introducing a ‘reaction coordinate’, which reduces the dimensionality of the information, and helps to visu-alize the free energy proﬁle along the migration channel.Below we shall note certain technicalities of the mapping pro-cedure:
The separation between two neighboring Na1 sites (∼ 6.4 Å), is di-vided into ﬁne bins (of size 0.1 Å). The distance r¯s1(i) = r¯s −r¯1(i), where r¯1(i) is the location of ith Na1 site, is searched over all Na1 sites in the simulation cell. Whenever this distance is less than 6.4 Å under PBC, the F(r¯s) is cumulated in an appropriate bin, say indexed j, which spans the reaction coordinate, λ . The quan-tity is then averaged over the counts registered in each bin. That is, where < ··· > j represent the average over the trajectory in a given bin j. It shall be noted that, the migration channel being the one connecting two neighboring Na1 (which shall be demonstrated in the later sections), for every hill-drop locations, r¯s, there would be two i values (that is, Na1 sites) which would meet the above crite rion. It shall be remarked further that the above mapping proce-dure is not unique and any other method of mining the F(r¯s) data onto repeating segments of trajectories may also be employed.The free-energy proﬁle from MTD simulation is compared with other compatible quantities, such as the potential energy proﬁle of individual Na+ ions, and potential energy barrier employing nudged-elastic-band (NEB) calculations, detailed as bellow:1. The potential energy proﬁle: the average potential energy of individual Na+ ions at a given location, r¯i, due to all the rest of the ions in the system, where N is the total number of ions (including mobile as well as those of the framework) in the system and U(r¯i j) is the pair-wise interaction potential as in eq. (1). The quantity, U(r¯i), computed from the MTD trajectory, is mapped on to reaction coordinate, λi (under periodic boundary conditions), as discussed earlier. The U(λi), thus calculated is averaged over all the Na+ ions and over the entire MD tra-jectory.
2. From climbing-image nudged elastic band (CI-NEB)54,55 for a single Na+ ion crossing over from one Na1 site to its neigh-bouring site.
Structural stability: Radial distribution functions (RDFs) for Zr−O, P/Si−O, O−O pairs have been calculated to check the stability of the framework, during the MTD as well as MD simula-tions at 500 K. Figure 1 shows the dynamic RDFs for NaZr2(PO4)3 (top panel) and Na4Zr2(PO4)3 (bottom panel), along with the corresponding static RDFs calculated from the X-ray structure.51The ﬁrst peak positions of Zr−O are around 2.09 Å for both NaZr2(PO4)3 and Na4Zr2(SiO4)3 systems. For the RDFs of P−O (top panel) and Si−O pairs (bottom panel) these are around 1.52 Å and 1.61 Å, respectively. These distances essentially corre-sponds to their respective bond lengths, and are in good agree-ment with experimental reports.51,56,57 The nearest-neighbour coordination numbers, C(n), for Zr−O are 6, while that of P−O and Si−O are 4, as expected of the polyhedral structure of NASICONs involving ZrO6 octahedra and (P/Si)O4 tetrahedra. These observations conﬁrms the structural stability of NASICON frame-work during MD and MTD simulation at 500 K. Having conﬁrmed the structural stability, we shall demonstrate how the MTD simu-lations accelerate the ion transport facilitating access to relevant microscopic insights, where the standard MD fails. The results on NASICON systems, NaZr2(PO4)3 and Na4Zr2(SiO4)3, chosen for these demonstrations shall be discussed separately in the next two sub-sections.
Figure 2 (top) shows the distribution of Na+ -ions in the simu-lation super-cell (consisting of 3 × 3 × 1 rhombohedral unit cells) sampled over 100 ns of standard MD simulations. Evidently, the Na+ ions are exhibiting only thermal vibrations about their equi-librium positions without making any visible jump to neighbour-ing sites. Thus, weighed down by the timescale of ion hops the standard MD simulation does not yield any practical insights on the nature or mechanism of ions transport. On the other hand, the MTD trajectory of the ’tagged’ Na+ ion (Figure 2, bottom), on which the external potential has been applied, explores nearly the entire simulation cell gradually over the 100 ns of simulation. The external potential or ‘hills’, gradually deposited at locations, already visited by the ions, builds up over the period and com-pensates for the underlying local minimum enabling the ions to migrate to other favorable sites. A more quantitative measure of this ‘accelerated dynamics’ is presented in Figure3, where the mean square displacement (MSD) of Na+ ions, where r(t) is the position vector of an ion at time t, and <...> in-dicate averaged over all ions of the same species and over several time-origins, are compared. However, to note a disadvantage,tough in typical MD studies the self-diffusion coefﬁcient can be estimated directly, by the Einstein’s relation, D = MSD6t (t) , the same does not apply in MTD simulations as the process is ‘artiﬁcially’ accelerated.The Na+ − Na+ RDF (Figure 4), calculated from the MTD tra-jectory, offer insights on the ion transport in the system. The ﬁrst peaks of the RDF appears at around 6.3 Å which measures the distance between two neighbouring Na1 sites (6b positions of R3¯c space group). The second peak is at around 9.1 Å corresponds to the next-neighbour distance between two Na1 sites. This reﬂects the fact that in NaZr2(PO4)3 all the Na+ ions prefers to occupy the Na1 sites, and also the Na+ hops occurs from one Na1 to the near-est Na1 site. Most experimental and computer simulation studies on this material have suggested this mechanism earlier.49–51,58,59For better convergence of the free energy proﬁle the ‘tagged’ particle need to sample a signiﬁcant fraction of the individual lo-cal minima and the saddle points connecting them. For instance, in Figure 5, the free energy barrier measures 0.24 eV after 10 ns, while from 20 ns onward the barrier starts converging, and settles to the value of 0.34 eV over the period of 100 ns.
Figure 6 shows the free energy (Eqs. (4) and (5)) and potential energy proﬁles (Eq. (6)) calculated from the entire MTD trajectory of 100 ns, along with that from NEB calculations. The barriers calculated from different proﬁles show comparable val-ues ranging between ∼ 0.35 − 0.4 eV. It shall be noted that all the energy proﬁles indicates energy minimum at Na1 sites, and the saddle point is located at the Na2 site. This is in agreement with the Na+-Na+ dynamic rdf shown in ﬁgure 4, that the Na+ ions preferentially occupy the Na1 sites NaZr2(PO4)3. The calculated values of the microscopic barriers are also in good agreement previous studies.60,61The ion migration channel connecting two Na1-sites and the built-up external potential along it is illustrated in Figure 7. The observed migration channel is consistent with the previous MD simulations on the high conducting Na3Zr2Si2PO12 sys-tem.50,58,59 Figure 7(left) shows the minimum energy path (MEP)of Na+ from one Na1-site to the neighbouring Na1 site obtained from the NEB calculation. This compares well with the proﬁle of external potential deposited over the 100 ns long MTD run on select plane containing two neighbouring Na1-sites and the Na2-site in the channel, shown in Figure 7(right). It can be seen that the ‘hills’ are developed at the two energetically favorable Na1-sites, with a low-ridge connecting the two, depicting the mi-gration channel. The nature of the channel is qualitatively very similar to that of the minimum energy path from NEB calcula-tions, and the absence of any local maximum in the channel is indicative of fact that Na2-sites are energetically not favorable.Having examined the utility of MTD simulations for ion transport in NaZr2(PO4)3, we shall demonstrate the same for Na4Zr2(SiO4)3, where the results are less direct, or more intrigu-ing on a primary inspection.
The silicate end member of NASICONs, Na4Zr2(SiO4)3, shares the same structural feature as its phosphate counterpart, NaZr2(PO4)3, discussed above. However, the former packs-up four times Na+ ions in about the same volume. This high ‘packing ratio’ makes it much harder for the Na+ ions move in the lattice. Figure 8 (top) shows the distribution of Na+ ions in the simula-tion cell, consisting of 3 × 3 × 1 rhombohedral unit cells, sampled from 100 ns of standard MD run. As in the previous case, stan-dard MD simulations observe only the thermal vibrations of Na+ about their equilibrium positions during the period. Thus the Na+ transport remains inaccessible due to the long times scales of the process. Figure 8 (bottom) shows the MTD trajectory of the single Na+ ion on which the external potential is applied. Due slower transport, the Na+ ion could not explore the simulation box sufﬁciently during 100 ns of time (shown in red), initially dedicated. Hence, the simulation is continued for another 100 ns of MTD-simulation (shown in olive green). The mean squared displace-ment of Na+ ions calculated from the MTD trajectory (averaged over all Na+ ions and over several time-origins, as in the previous case) is presented in Figure 9.
Figure 10 shows the Na+-Na+ RDF calculated from MTD tra-jectory, along with the X-ray distributions of the sites, Na1-Na1 (brown), Na1-Na2 (green) and Na2-Na2 (blue). The ﬁrst peak of the dynamic RDF corresponds to the Na1-Na2 distance ( 3.4Å), the second peak to the Na2-Na2 distance ( 4.9Å), and the third and fourth peaks are respectively ﬁrst and second Na1-Na1 neigh-bor distances. Thus, as required by the composition all the Na1 and Na2 sites remain occupied. The diffusion channel of Na+ re-vealed by the MTD trajectory also remains the same, as the one connecting Na1-Na2-Na1-sites.
Calculation of the energy proﬁle, F, for Na4Zr2(SiO4)3 has been carried out from the accumulated external potential in a similar fashion as in the previous case. The convergence of the proﬁle (plotted as function of the reaction coordinate, λi) with the progress of the MTD run demonstrated in Figure 11. As seen, the proﬁle signiﬁcantly vary for run-lengths of 20 ns, 60 ns and 70 ns. For run-lengths 80 ns and larger, the proﬁle starts converging measuring a barrier of about 0.34 eV. In Figure 12 the converged free energy proﬁle, F, from MTD simulation is compared with the average potential energy proﬁles of individual Na+ ions sampled from the MTD trajectory, and that from the Nudged Elastic Band (NEB) calculations. The NEB calculations are performed only be-tween two neighboring Na1 and Na2 sites.The free energy barriers for Na+ transport in Na4Zr2(SiO4)3 is observed to be qualitatively different from that of NaZr2(PO4)3 in Figure 5. Unlike in NaZr2(PO4)3, the Na2-location is now a local minimum, with the peak of the proﬁle shifting to, roughly, mid-way between the Na1 − Na2 channel. The free energy barrier of 0.34 eV, from the MTD is in good agreement with experimental activation barrier of 0.347 eV by Tran Qui et al.57The most intriguing aspect in Figure 12 is that the potential energy proﬁles of individual Na+ ions, both from MTD and NEB calculations, are at sharp contrast to the free-energy proﬁles. The barrier heights of the potential energy proﬁles are about 0.15 eV which is much lower than the barrier obtained from the free energy proﬁle (∼ 0.34 eV) as well as with the experimental ac-tivation energy. This behaviour is attributed to the high degree of ion-ion correlation in the system. In the NASICON solid solution Na1+xZr2SixP3-xO12 (0 ≤ x ≤ 3.0) ion-ion correlations are expected to increase with the concentration of the mobile ions x. It shall be recalled that many studies in the past51,62,63 have attributed the anomalously high conductivity of Na3Zr2Si2PO12 to an ‘optimal’ ion-ion correlation. From a contextual perspective, we shall note that the Na4Zr2(SiO4)3 system contains four times more Na+ ions compared to NaZr2(PO4)3, necessitating that all the Na1 and Na2-sites in the lattice be occupied. The migration channel in the structure being the one connecting Na1 − Na2 − Na1-sites,50,58,59 no Na+ ions can jump to any of the neighbouring sites independently. Thus, it shall be inferred that the Na+ transport in the framework involves correlated hops of multiple Na+ ions. In Figure S1 (see supporting information†) the correlated hops of Na+ ions are demonstrated using the tra-jectories of arbitrarily picked ions along with some of their neigh-bours. In MTD simulations, the tagged Na+ ion (on which the external potential are imposed) propels all the participating Na+ ions in this correlated motion, thus the ‘total effective cost’ of the event is reﬂected in F, while individual Na+ ions experience only a ‘fractional share’ of it. Thus F is the more appropriate measure of the diffusion barrier.Figure 13 demonstrates the MEP for Na+ from one Na1-site to the neighbouring Na2 site obtained from the NEB calcula-tion. This is compared with proﬁle of external potential deposited over one segment of the of the conduction channel connecting Na1 − Na2 − Na1-sites. Like the previous case, two neighbour-ing Na1 sites develops maximum external potential, indicating the free-energy minima at Na1 sites. However, in contrast, for Na4Zr2(SiO4)3 system there is a local maximum of the external potential formed between the two Na1-sites which corresponds to the local free-energy minima at Na2 site.Before summarizing the results we shall brieﬂy examine the re-sults for different values of the bias factors, namely for γ = 3 and γ = 9, relative to γ = 6, for which the above results are discussed. It shall be noted in ﬁgure S2 (see supporting information†) that for γ = 3 the tagged particle does not explore the conﬁgurational space efﬁciently. In NaZr2(PO4)3, for γ = 3, the tagged particle makes several unsuccessful attempts to hop to its six neighbouring Na1 sites during the 100ns of simulation, while for Na4Zr2(SiO4)3 the tagged ion successfully hops to one of its neighbouring Na1 sites, but fails to explore any further during the 200 ns of simulation. On the other hand, for bias factor γ = 9, vi-sually the entire simulation cell is visited by the tagged ion in both the systems, as was the case for γ = 6. Demonstrated in Figure S3(†) (for γ = 6) is the fact that for large enough bias factor the tagged particle attempts several hops to neighbouring sites before being successful. As this process continues in each of the minima (Na-sites) encountered by the tagged ion, the corresponding wells gets ﬁlled out evenly by the dropped hills. However, for very large bias factors (not shown), say γ = ∞ (that is, with out the ’tuning’ of the hills), the tagged ion explores the conﬁguration space rather too fast, that is, without sampling the local minima sufﬁciently. This causes uneven ﬁlling of the minima causing larger errors in the free energy estimates. Thus, for an optimal range of γ values, the tagged ion samples the local minima fairly extensively, while also explores the rest of the accessible conﬁguration space within affordable time scales. And as seen in Figure S4(†) the resulting free energy proﬁle for γ = 9 is very similar to that of γ = 6 for both the systems. Thus the choice of γ in the range of 6 to 9 for these systems seem adequate.
The general utility of metadynamics technique in accessing slow diffusion in solid electrolytes is explored for the prototypical phos-phate and silicate end members of the ‘true’ NASICON solid solu-tion, Na1+xZr2SixP3-xO12 (where 0 ≤ x ≤ 3.0). We shall note in passing that, in contrast to previous MTD implementations,31–35where a distance measure from a select origin was chosen as the collective variable, the present simulation employs the Cartesian coordinates of a ‘tagged’ ion as the collective variables. However, without further investigations it is hard to compare the efﬁcien-cies of these two implementations.The MTD method involves imposition of external Gaussian ‘hills’ on the tagged ion or the ‘walker’, at regular intervals fol-lowing the well-tempered variant of the algorithm. As the hills starts ﬁlling out the local energy minimum the ion starts explor-ing other parts of the conﬁgurational space, resulting in the trans-port of ions across the matrix. The migration channel of the ions in the NASICON structure is found to be the one connecting Na1 − Na2 − Na1-sites, consistent with the previous MD simulations on the high conducting Na3Zr2Si2PO12 system. The hills imposed are reconstructed, and mapped on to the separation between two neighbouring Na+ sites (namely, Na1 and Na2) in the conduction channel, chosen as the ‘reaction coordinate’. Thus, the microscopic free-energy proﬁle of the ions in the migration channel is constructed. As demonstrated, for better convergence of the free-energy barrier the walker need to explore a signiﬁ-cant fraction of the individual local minima and the saddle points connecting them.In the phosphate end member, NaZr2(PO4)3, the free energy proﬁles from MTD calculations are in agreement with the individ-ual potential energy of ions and with nudged-elastic band (NEB) calculations. And the estimated barrier agrees well with the acti-vation barrier reported in experiments. For the silicate end member, Na4Zr2(SiO4)3, the MTD free energy barrier remains in good agreement with experimental values, however quantitatively dif-ferent from the potential energy proﬁles, from MTD as well as from NEB calculations. This has been attributed to the high-degree of correlated hops of Na+ ions. The situation is analogous to a freight engine pulling several carriages over a mountainous terrine, wherein the engine (akin to the ‘walker’) accounts for the entire energy expended, while the work done by individual car-ries (akin to the other ions) measure only the fractional share of the gross.Thus, the metadynamics approach facilitates investigation of the mechanism and microscopic energetics of diffusion in con-densed phases, overcoming to a great extent, the time-scale lim-itations typical to atomistic simulation studies. We hope that the present study will further stimulate and guide metadynam-ics studies of atomic/molecular diffusion in condensed states of matter.